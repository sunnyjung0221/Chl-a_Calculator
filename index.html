<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Chl-a Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      position: relative;
      z-index: 1;
    }
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-image: url('image.png');
      background-size: 70%;
      background-repeat: no-repeat;
      background-position: center;
      opacity: 0.15;
      z-index: -1;
    }

    h1 { text-align: left; margin-bottom: 35px; }

    .row { 
      display: flex; 
      gap: 10px; 
      align-items: center; 
      margin-bottom: 8px; 
      flex-wrap: wrap; 
    }
    label { font-weight: bold; min-width: 70px; }

    input, select { height: 30px; text-align: center; width: 80px; }

    /* üîÑ Î≤ÑÌäº */
    button {
      width: 32px;
      height: 32px;
      font-size: 18px;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 25%;   /* ‚≠ï ÎèôÍ∑∏ÎùºÎØ∏ Î™®Ïñë */
      border: 1px solid #aaa;
      background-color: #fff;
    }

    .section-title { font-weight: bold; margin-top: 16px; margin-bottom: 6px; font-size: 16px; }
    .footer { text-align: left; margin-top: 30px; font-size: 12px; color: #888; }

    /* ÏúÑ ÎπÑÍµê Î∏îÎ°ù */
    .compare { margin-bottom: 35px; }
    .compare .label-narrow { min-width: 60px; }

    /* Size Ìï©Í≥Ñ Ï§ÑÎßå Í∞ÑÍ≤© Ï§ÑÏù¥Í∏∞ */
    .sum-row {
      margin-top: 10px;
      font-weight: bold;
      gap: 4px;
    }
    .sum-row label { 
      margin-right: 2px;
      min-width: auto;
    }

    /* ver. Ï§ÑÎßå Í∞ÑÍ≤© Ï¢ÅÌûàÍ∏∞ */
    .row.ver-row {
      gap: 4px;   /* Í∏∞Î≥∏ 10px ‚Üí 4px */
    }
  </style>
</head>
<body>
  <h1>Chl-a Calculator</h1>

  <!-- ===== ÏúÑ ÎπÑÍµê Î∏îÎ°ù ===== -->
  <div class="compare">
    <div class="row">
      <label class="label-narrow">10-AU</label>
      <input type="number" inputmode="decimal" id="auInput" oninput="recalcCompare()">
      <input type="number" inputmode="decimal" id="auDenom" value="300" oninput="recalcCompare()">
      <input type="text" id="auResult" readonly>
    </div>
    <div class="row">
      <label class="label-narrow">Trilogy</label>
      <input type="number" inputmode="decimal" id="triInput" oninput="recalcCompare()">
      <input type="number" inputmode="decimal" id="triDenom" value="300" oninput="recalcCompare()">
      <input type="text" id="triResult" readonly>
    </div>
    <div class="row">
      <label class="label-narrow">Ïò§Ï∞®</label>
      <input type="text" id="cmpError" readonly>
    </div>
  </div>

  <!-- Ver ÏÑ†ÌÉù + ÏÉàÎ°úÍ≥†Ïπ® -->
  <div class="row ver-row">
    <label for="verSelect">ver.</label>
    <select id="verSelect" onchange="recalculateAll()">
      <option value="0.968">10-AU</option>
      <option value="0.1691">Trilogy</option>
    </select>
    <button onclick="resetAll()">üîÑ</button>
  </div>

  <!-- ===== ÏïÑÎûò Í≥ÑÏÇ∞Í∏∞ ===== -->
  <div class="section-title">Total</div>
  <div class="row">
    <input type="number" inputmode="decimal" class="inputVal" oninput="recalculateAll()">
    <input type="number" inputmode="decimal" class="denomVal" value="300" oninput="recalculateAll()">
    <input type="text" class="resultVal" id="totalResult" readonly>
  </div>

  <div class="section-title">Size</div>
  <div class="row">
    <input type="number" inputmode="decimal" class="inputVal" placeholder="Size a" oninput="recalculateAll()">
    <input type="number" inputmode="decimal" class="denomVal" value="500" oninput="recalculateAll()">
    <input type="text" class="resultVal sizeResult" readonly>
  </div>
  <div class="row">
    <input type="number" inputmode="decimal" class="inputVal" placeholder="Size b" oninput="recalculateAll()">
    <input type="number" inputmode="decimal" class="denomVal" value="500" oninput="recalculateAll()">
    <input type="text" class="resultVal sizeResult" readonly>
  </div>
  <div class="row">
    <input type="number" inputmode="decimal" class="inputVal" placeholder="Size c" oninput="recalculateAll()">
    <input type="number" inputmode="decimal" class="denomVal" value="500" oninput="recalculateAll()">
    <input type="text" class="resultVal sizeResult" readonly>
  </div>

  <div class="row sum-row">
    <label>Size Ìï©Í≥Ñ</label>
    <input type="text" id="sizeSum" readonly>
    <label>Ïò§Ï∞®</label>
    <input type="text" id="errorVal" readonly>
  </div>

  <div class="footer">2025-08-21 last updated JHM</div>

  <script>
    const COEFF_AU = 0.968;
    const COEFF_TRI = 0.1691;

    function recalcCompare() {
      const auIn  = parseFloat(document.getElementById('auInput').value);
      const auDen = parseFloat(document.getElementById('auDenom').value);
      const triIn  = parseFloat(document.getElementById('triInput').value);
      const triDen = parseFloat(document.getElementById('triDenom').value);

      let auRes = null, triRes = null;

      if (!isNaN(auIn) && !isNaN(auDen) && auDen !== 0) {
        auRes = auIn * COEFF_AU * (10 / auDen);
        document.getElementById('auResult').value = auRes.toFixed(4);
      } else {
        document.getElementById('auResult').value = '';
      }

      if (!isNaN(triIn) && !isNaN(triDen) && triDen !== 0) {
        triRes = triIn * COEFF_TRI * (10 / triDen);
        document.getElementById('triResult').value = triRes.toFixed(4);
      } else {
        document.getElementById('triResult').value = '';
      }

      document.getElementById('cmpError').value =
        (auRes !== null && triRes !== null) ? (auRes - triRes).toFixed(4) : '';
    }

    function recalculateAll() {
      const coeff = parseFloat(document.getElementById("verSelect").value);
      const inputBoxes = document.querySelectorAll(".inputVal");
      const denomBoxes = document.querySelectorAll(".denomVal");
      const resultBoxes = document.querySelectorAll(".resultVal");
      const sizeSumBox = document.getElementById("sizeSum");
      const errorBox = document.getElementById("errorVal");

      let sizeValues = [];
      let totalResult = null;

      for (let i = 0; i < inputBoxes.length; i++) {
        const input = parseFloat(inputBoxes[i].value);
        const denom = parseFloat(denomBoxes[i].value);

        if (!isNaN(input) && !isNaN(denom) && denom !== 0) {
          const result = input * coeff * (10 / denom);
          resultBoxes[i].value = result.toFixed(4);
          if (i === 0) totalResult = result;
          else sizeValues.push(result);
        } else {
          resultBoxes[i].value = "";
          if (i === 0) totalResult = null;
        }
      }

      const sum = sizeValues.reduce((acc, v) => acc + v, 0);
      sizeSumBox.value = sizeValues.length ? sum.toFixed(4) : "";
      errorBox.value = (totalResult !== null && sizeValues.length) ? (totalResult - sum).toFixed(4) : "";
    }

    function resetAll() {
      document.getElementById('auInput').value = '';
      document.getElementById('triInput').value = '';
      document.getElementById('auDenom').value = '300';
      document.getElementById('triDenom').value = '300';
      document.getElementById('auResult').value = '';
      document.getElementById('triResult').value = '';
      document.getElementById('cmpError').value = '';

      document.querySelectorAll(".inputVal").forEach(el => el.value = "");
      document.querySelectorAll(".denomVal").forEach((el, i) => el.value = (i === 0 ? "300" : "500"));
      document.querySelectorAll(".resultVal").forEach(el => el.value = "");
      document.getElementById("sizeSum").value = "";
      document.getElementById("errorVal").value = "";
    }
  </script>
</body>
</html>


